<!DOCTYPE html>
<html lang="zh-CN" data-webtui-theme="catppuccin-mocha">
<head>
  <meta charset="UTF-8">
  <title>noir :: cv</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href="favicon.png">

  <!-- WebTUI -->
<link rel="stylesheet" href="assets/webtui-full.css">


  <!-- markdown-it -->
  <script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>

  <style>
    :root { --tui-border:#888; }
    html,body{height:100%;margin:0}
    body{background:rgb(255,255,255);}
    .window-wrapper{height:100%;padding:1lh;box-sizing:border-box}
    .window{display:grid;grid-template-rows:auto 1fr auto;height:100%;border:2px solid #000;}
    .header{display:flex;justify-content:space-between;align-items:center;padding:.5lh 1ch;border-bottom:1px solid var(--tui-border)}
    .header a{text-decoration:none;color:var(--tui-fg);border:1px solid var(--tui-border);padding:.2lh .5ch;border-radius:.25ch}
.content{
  display:grid;
  grid-template-columns: var(--tree-w, 28ch) 1fr;
  min-height:0;
  transition: grid-template-columns .25s ease;
}
    .tree{border-right:1px solid var(--tui-border);padding:.5lh 1ch;overflow-y:auto}
    .tree ul{list-style:none;padding:0;margin:0}
    .tree li{cursor:pointer;padding:.1lh .5ch}
/* 左侧目录：选中项改为淡色背景（不反色） */
/* 左侧目录：选中项淡色背景（带兼容 fallback） */
.tree li.active{
  background: rgba(100,149,237,0.6); /* fallback */
  color: var(--tui-fg);
  border-radius: .35ch;
}

.tree li:hover{
  background: rgba(100,149,237,0.5);
  border-radius: .35ch;
}

    .viewer{padding:1lh 2ch;overflow-y:auto}
    .status{padding:.5lh 1ch;border-top:1px solid var(--tui-border)}

    /* Markdown 样式（Butterfly-ish） */
    .md-body h1{font-size:1.8em;border-bottom:1px solid var(--tui-border);padding-bottom:.2em}
    .md-body h2{font-size:1.5em;border-bottom:1px solid var(--tui-border);padding-bottom:.2em}
    .md-body h3{font-size:1.25em;border-bottom:1px solid var(--tui-border);padding-bottom:.2em}
    .md-body p{line-height:1.75}
    .md-body blockquote{border-left:4px solid #666;padding-left:1em;color:#aaa}
    .md-body code{background:#111;padding:.1em .3em;border-radius:4px}
    .md-body pre{background:#111;padding:1em;overflow-x:auto}
    .md-body hr{border:0;border-top:1px solid var(--tui-border);margin:1.5em 0}
    .md-body ul{padding-left:2ch}
    .md-body li{margin:.3em 0}
    .md-body img{max-width:100%;border-radius:8px;margin:1em 0}
    .md-body a{color:#8aadf4;text-decoration:none}
    .md-body a:hover{text-decoration:underline}
    /* 折叠状态 */
.content.tree-collapsed{
  grid-template-columns: 0 1fr;
}

.content.tree-collapsed .tree{
  overflow: hidden;
  padding: 0;
  border-right: none;
}
#tree-toggle{
  border:1px solid var(--tui-border);
  background:transparent;
  color:var(--tui-fg);
  cursor:pointer;
  padding:.1lh .6ch;
  border-radius:.25ch;
  font-size:0.9em;
}
#tree-toggle:hover{
  background:var(--tui-fg);
  color:var(--tui-bg);
}

  </style>
</head>

<body>
<div class="window-wrapper">
  <div class="window">

    <div class="header">
<div style="display:flex;align-items:center;gap:1ch">
  <button id="tree-toggle" aria-label="Toggle sidebar">目录◀</button>
  <span>~/cv</span>
</div>
<a href="https://maonie.neocities.org/index2" data-home-link>返回主页</a>
<script src="/assets/window-mode.js"></script>

    </div>

    <div class="content">
      <nav class="tree">
        <ul>
          <li class="active">序言.md</li>
          <li>我死前的记录.md</li>
        </ul>
      </nav>

      <main class="viewer">
        <div id="viewer-content" class="md-body">Loading...</div>
      </main>
    </div>

    <div class="status">Path: ~/cv/article/about.md</div>

  </div>
</div>

<script>
const items = document.querySelectorAll('.tree li');
const viewer = document.getElementById('viewer-content');
const status = document.querySelector('.status');

// Hexo-ish markdown-it
const md = window.markdownit({
  html: true,
  linkify: true,
  typographer: true
}).use(function(md){
  md.core.ruler.push('heading_id', state=>{
    state.tokens.forEach((t,i)=>{
      if(t.type === 'heading_open'){
        const inline = state.tokens[i+1];
        const text = inline.content;
        const id = text.trim().toLowerCase().replace(/[^\w\u4e00-\u9fa5]+/g,'-');
        t.attrSet('id', id);
      }
    });
  });
});

function stripFrontMatter(raw){
  if(raw.startsWith('---')){
    const end = raw.indexOf('\n---', 3);
    if(end !== -1){
      return raw.slice(end + 4);
    }
  }
  return raw;
}

async function loadFile(name){
  status.textContent = `Path: ~/cv/article/${name}`;
  viewer.innerHTML = 'Loading...';

  try{
    const res = await fetch(`article/${name}`);
    if(!res.ok) throw new Error();
    let text = await res.text();

    text = stripFrontMatter(text);      // 模拟 Hexo Front-Matter
    viewer.innerHTML = md.render(text); // Hexo-ish 渲染

  }catch(e){
    viewer.textContent = `⚠️ 无法读取 article/${name}`;
  }
}

items.forEach(item=>{
  item.addEventListener('click',()=>{
    items.forEach(i=>i.classList.remove('active'));
    item.classList.add('active');
    loadFile(item.textContent.trim());
  });
});

// 默认加载第一个
loadFile(items[0].textContent.trim());
const content = document.querySelector('.content');
const toggleBtn = document.getElementById('tree-toggle');

function updateToggleIcon(){
  toggleBtn.textContent =
    content.classList.contains('tree-collapsed') ? '目录▶' : '目录◀';
}

toggleBtn.addEventListener('click',()=>{
  content.classList.toggle('tree-collapsed');
  updateToggleIcon();
});

// —— 手机端：默认折叠
if(window.matchMedia('(max-width: 760px)').matches){
  content.classList.add('tree-collapsed');
  updateToggleIcon();
}

</script>
<script src="/assets/window-mode.js" defer></script>


</body>
</html>
